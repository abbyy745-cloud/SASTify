<!DOCTYPE html>
<html>

<head>
    <title>SASTify Technical Documentation</title>
    <style>
        body {
            font-family: Calibri, Arial, sans-serif;
            max-width: 900px;
            margin: 40px auto;
            padding: 20px;
            line-height: 1.6;
        }

        h1 {
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
        }

        h2 {
            color: #34495e;
            border-bottom: 2px solid #ecf0f1;
            padding-bottom: 8px;
            margin-top: 40px;
        }

        h3 {
            color: #7f8c8d;
        }

        .diagram {
            text-align: center;
            margin: 30px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .diagram img {
            max-width: 100%;
            height: auto;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        .diagram-caption {
            font-style: italic;
            color: #666;
            margin-top: 10px;
        }

        table {
            border-collapse: collapse;
            width: 100%;
            margin: 20px 0;
        }

        th,
        td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }

        th {
            background-color: #3498db;
            color: white;
        }

        tr:nth-child(even) {
            background-color: #f2f2f2;
        }

        .highlight {
            background-color: #fff3cd;
            padding: 15px;
            border-left: 4px solid #ffc107;
            margin: 20px 0;
        }

        .success {
            background-color: #d4edda;
            padding: 15px;
            border-left: 4px solid #28a745;
            margin: 20px 0;
        }

        code {
            background-color: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: Consolas, monospace;
        }

        .page-break {
            page-break-after: always;
        }
    </style>
</head>

<body>

    <h1>üõ°Ô∏è SASTify - Complete Technical Documentation</h1>
    <p><strong>Version:</strong> 1.0 | <strong>Date:</strong> December 5, 2024</p>
    <p><strong>Description:</strong> SASTify is a professional-grade Static Application Security Testing (SAST) tool
        specifically designed for Educational Technology (EdTech) platforms.</p>

    <div class="success">
        <strong>Current Rating: 8.5/10</strong> - SASTify is the only SAST tool with 57 EdTech-specific security rules,
        making it unique in the market.
    </div>

    <hr>

    <h2>1. System Architecture</h2>

    <div class="diagram">
        <p><em>[Insert Image: 1_architecture.png from the docs folder]</em></p>
        <p class="diagram-caption">Figure 1: SASTify System Architecture</p>
    </div>

    <h3>Components Overview</h3>
    <table>
        <tr>
            <th>Component</th>
            <th>Technology</th>
            <th>Purpose</th>
        </tr>
        <tr>
            <td>VS Code Extension</td>
            <td>TypeScript</td>
            <td>User interface, inline diagnostics, results panel</td>
        </tr>
        <tr>
            <td>FastAPI Backend</td>
            <td>Python</td>
            <td>REST API server, request handling, rate limiting</td>
        </tr>
        <tr>
            <td>Analysis Engine</td>
            <td>Python</td>
            <td>Multi-layer vulnerability scanning</td>
        </tr>
        <tr>
            <td>Cross-File Taint Engine</td>
            <td>Python</td>
            <td>Inter-procedural data flow analysis</td>
        </tr>
        <tr>
            <td>DeepSeek AI</td>
            <td>External API</td>
            <td>Human-readable vulnerability explanations</td>
        </tr>
    </table>

    <div class="page-break"></div>

    <h2>2. Data Flow</h2>

    <div class="diagram">
        <p><em>[Insert Image: 2_data_flow.png from the docs folder]</em></p>
        <p class="diagram-caption">Figure 2: Complete Data Flow from User to Results</p>
    </div>

    <h3>Step-by-Step Process</h3>
    <ol>
        <li><strong>User Triggers Scan</strong> - User clicks "Scan File" in VS Code</li>
        <li><strong>API Request</strong> - Extension sends POST to <code>/api/scan</code> with code and language</li>
        <li><strong>Backend Processing</strong> - FastAPI initializes the EnhancedRuleEngine</li>
        <li><strong>Multi-Layer Analysis</strong> - Three parallel analysis methods:
            <ul>
                <li>AST-based taint tracking (highest accuracy)</li>
                <li>EdTech-specific rules (57 rules)</li>
                <li>Regex pattern matching (fallback)</li>
            </ul>
        </li>
        <li><strong>Deduplication</strong> - Results merged, duplicates removed</li>
        <li><strong>AI Enhancement</strong> - Optional DeepSeek explanation</li>
        <li><strong>Display</strong> - Results shown in VS Code panel with inline markers</li>
    </ol>

    <div class="page-break"></div>

    <h2>3. Taint Tracking System</h2>

    <div class="diagram">
        <p><em>[Insert Image: 3_taint_tracking.png from the docs folder]</em></p>
        <p class="diagram-caption">Figure 3: Taint Tracking - Sources, Propagation, and Sinks</p>
    </div>

    <h3>Sources (Where Untrusted Data Enters)</h3>
    <table>
        <tr>
            <th>Language</th>
            <th>Sources</th>
        </tr>
        <tr>
            <td>Python</td>
            <td><code>request.args</code>, <code>request.form</code>, <code>request.json</code>, <code>input()</code>,
                <code>sys.argv</code></td>
        </tr>
        <tr>
            <td>JavaScript</td>
            <td><code>req.body</code>, <code>req.query</code>, <code>req.params</code>, <code>document.location</code>,
                <code>localStorage</code></td>
        </tr>
        <tr>
            <td>EdTech</td>
            <td><code>student_id</code>, <code>student_name</code>, <code>cnic</code>, <code>exam_token</code>,
                <code>user_input</code></td>
        </tr>
    </table>

    <h3>Sinks (Where Tainted Data Is Dangerous)</h3>
    <table>
        <tr>
            <th>Vulnerability</th>
            <th>Sinks</th>
        </tr>
        <tr>
            <td>SQL Injection</td>
            <td><code>cursor.execute()</code>, <code>db.query()</code>, <code>connection.execute()</code></td>
        </tr>
        <tr>
            <td>Code Injection</td>
            <td><code>eval()</code>, <code>exec()</code>, <code>Function()</code>, <code>setTimeout()</code></td>
        </tr>
        <tr>
            <td>Command Injection</td>
            <td><code>os.system()</code>, <code>subprocess.run()</code>, <code>child_process.exec()</code></td>
        </tr>
        <tr>
            <td>XSS</td>
            <td><code>innerHTML</code>, <code>document.write()</code>, <code>render_template_string()</code></td>
        </tr>
    </table>

    <h3>Sanitizers (What Breaks Taint)</h3>
    <p><code>html.escape()</code>, <code>bleach.clean()</code>, <code>DOMPurify.sanitize()</code>,
        <code>encodeURIComponent()</code>, parameterized queries</p>

    <div class="highlight">
        <strong>How It Works:</strong> When a variable receives data from a SOURCE, it becomes "tainted." This taint
        propagates through assignments and function calls. If tainted data reaches a SINK without passing through a
        SANITIZER, a vulnerability is reported.
    </div>

    <div class="page-break"></div>

    <h2>4. Cross-File Analysis</h2>

    <div class="diagram">
        <p><em>[Insert Image: 4_cross_file.png from the docs folder]</em></p>
        <p class="diagram-caption">Figure 4: Cross-File Analysis Process</p>
    </div>

    <h3>Four-Phase Analysis</h3>

    <table>
        <tr>
            <th>Phase</th>
            <th>Component</th>
            <th>Output</th>
        </tr>
        <tr>
            <td>1. Indexing</td>
            <td>ProjectAnalyzer</td>
            <td>Symbol table mapping function names to file locations</td>
        </tr>
        <tr>
            <td>2. Call Graph</td>
            <td>CallGraphBuilder</td>
            <td>Nodes (functions) and edges (calls) with entry points and sinks marked</td>
        </tr>
        <tr>
            <td>3. Summaries</td>
            <td>FunctionSummary</td>
            <td>Per-function: which params reach sinks or returns</td>
        </tr>
        <tr>
            <td>4. Propagation</td>
            <td>CrossFileTaintEngine</td>
            <td>Worklist algorithm finds paths from sources to sinks across files</td>
        </tr>
    </table>

    <h3>Example Detection</h3>
    <div class="highlight">
        <strong>app.py:</strong><br>
        <code>query = request.args.get('q')</code> ‚Üê SOURCE<br>
        <code>result = student_service.search(query)</code> ‚Üê Cross-file call<br><br>
        <strong>services.py:</strong><br>
        <code>def search(self, term):</code><br>
        <code>&nbsp;&nbsp;&nbsp;&nbsp;cursor.execute(f"SELECT * WHERE name = '{term}'")</code> ‚Üê SINK<br><br>
        <strong>Result:</strong> Cross-File SQL Injection detected!
    </div>

    <div class="page-break"></div>

    <h2>5. EdTech-Specific Rules (57 Total)</h2>

    <div class="diagram">
        <p><em>[Insert Image: 5_edtech_rules.png from the docs folder]</em></p>
        <p class="diagram-caption">Figure 5: EdTech Security Rules Distribution</p>
    </div>

    <h3>Rules by Category</h3>
    <table>
        <tr>
            <th>Category</th>
            <th>Rules</th>
            <th>Focus Area</th>
        </tr>
        <tr>
            <td>Student Data Protection</td>
            <td>15</td>
            <td>PII exposure, data in logs, unencrypted storage, URL exposure</td>
        </tr>
        <tr>
            <td>Exam Integrity</td>
            <td>12</td>
            <td>Answer exposure, client-side timers, grade manipulation, proctoring bypass</td>
        </tr>
        <tr>
            <td>AI/LLM Security</td>
            <td>10</td>
            <td>Prompt injection, AI grading without review, model output validation</td>
        </tr>
        <tr>
            <td>LMS Integration</td>
            <td>8</td>
            <td>LTI secret exposure, OAuth misconfig, SCORM tampering, API tokens</td>
        </tr>
        <tr>
            <td>Proctoring</td>
            <td>7</td>
            <td>Automation detection bypass, tab switching, screen capture evasion</td>
        </tr>
        <tr>
            <td>Access Control</td>
            <td>5</td>
            <td>Role from request, missing auth decorators, privilege escalation</td>
        </tr>
    </table>

    <h3>Compliance Coverage</h3>
    <table>
        <tr>
            <th>Regulation</th>
            <th>Rules</th>
            <th>Key Detections</th>
        </tr>
        <tr>
            <td>FERPA</td>
            <td>11</td>
            <td>Student PII exposure, unauthorized data access, educational records protection</td>
        </tr>
        <tr>
            <td>COPPA</td>
            <td>8</td>
            <td>Minor data handling, parental consent requirements, location tracking</td>
        </tr>
    </table>

    <h3>Severity Distribution</h3>
    <table>
        <tr>
            <th>Severity</th>
            <th>Count</th>
            <th>Examples</th>
        </tr>
        <tr>
            <td style="background:#dc3545;color:white;">Critical</td>
            <td>16</td>
            <td>Exam answers in client code, direct grade manipulation, bulk data export</td>
        </tr>
        <tr>
            <td style="background:#fd7e14;color:white;">High</td>
            <td>24</td>
            <td>PII in logs, prompt injection, unprotected endpoints</td>
        </tr>
        <tr>
            <td style="background:#ffc107;">Medium</td>
            <td>16</td>
            <td>Client-side timers, weak authentication patterns</td>
        </tr>
        <tr>
            <td style="background:#28a745;color:white;">Low</td>
            <td>1</td>
            <td>Informational patterns</td>
        </tr>
    </table>

    <div class="page-break"></div>

    <h2>6. TypeScript Support</h2>

    <h3>Parsing Capabilities</h3>
    <table>
        <tr>
            <th>Feature</th>
            <th>What It Extracts</th>
        </tr>
        <tr>
            <td>Functions</td>
            <td>Name, parameters with types, return type, async status</td>
        </tr>
        <tr>
            <td>Classes</td>
            <td>Name, extends, implements, methods, properties</td>
        </tr>
        <tr>
            <td>Interfaces</td>
            <td>Name, properties, extends</td>
        </tr>
        <tr>
            <td>Imports</td>
            <td>Module name, named imports, default imports</td>
        </tr>
        <tr>
            <td>Type Annotations</td>
            <td>Nullable (?), arrays ([]), generics (&lt;T&gt;), Promise types</td>
        </tr>
    </table>

    <h3>Type Safety Detections</h3>
    <table>
        <tr>
            <th>Issue</th>
            <th>Severity</th>
            <th>Pattern</th>
        </tr>
        <tr>
            <td>Dangerous Any Type</td>
            <td>Medium</td>
            <td><code>param: any</code> or <code>: any</code> return</td>
        </tr>
        <tr>
            <td>Type Safety Bypass</td>
            <td>High</td>
            <td><code>as any</code> or <code>&lt;any&gt;</code> casts</td>
        </tr>
        <tr>
            <td>Non-null Assertion</td>
            <td>Low</td>
            <td><code>value!.property</code></td>
        </tr>
        <tr>
            <td>Request Type Source</td>
            <td>High</td>
            <td>Parameter typed as <code>Request</code></td>
        </tr>
    </table>

    <div class="page-break"></div>

    <h2>7. Performance Metrics</h2>

    <table>
        <tr>
            <th>Benchmark</th>
            <th>Time (s)</th>
            <th>Memory (MB)</th>
            <th>Throughput</th>
        </tr>
        <tr>
            <td>Indexing (10 files)</td>
            <td>0.095</td>
            <td>0.3</td>
            <td>105 files/second</td>
        </tr>
        <tr>
            <td>Call Graph (10 files)</td>
            <td>0.003</td>
            <td>0.1</td>
            <td>14,769 funcs/second</td>
        </tr>
        <tr>
            <td>Function Summaries (10 files)</td>
            <td>0.422</td>
            <td>0.3</td>
            <td>190 funcs/second</td>
        </tr>
        <tr>
            <td>Taint Analysis (10 files)</td>
            <td>0.651</td>
            <td>0.5</td>
            <td>77 funcs/second</td>
        </tr>
        <tr>
            <td>Indexing (50 files)</td>
            <td>0.868</td>
            <td>1.1</td>
            <td>58 files/second</td>
        </tr>
        <tr>
            <td>Taint Analysis (50 files)</td>
            <td>18.633</td>
            <td>4.9</td>
            <td>27 funcs/second</td>
        </tr>
    </table>

    <div class="highlight">
        <strong>Key Metrics:</strong><br>
        ‚Ä¢ Average Indexing: 81 files/second<br>
        ‚Ä¢ Average Analysis: 52 functions/second<br>
        ‚Ä¢ Peak Memory: 4.9 MB
    </div>

    <div class="page-break"></div>

    <h2>8. File Structure</h2>

    <h3>Backend Files</h3>
    <table>
        <tr>
            <th>File</th>
            <th>Lines</th>
            <th>Purpose</th>
        </tr>
        <tr>
            <td>main.py</td>
            <td>~300</td>
            <td>FastAPI server, all API endpoints</td>
        </tr>
        <tr>
            <td>enhanced_rule_engine.py</td>
            <td>~1100</td>
            <td>Multi-layer scanner with AST and patterns</td>
        </tr>
        <tr>
            <td>edtech_rules.py</td>
            <td>~500</td>
            <td>57 EdTech-specific security rules</td>
        </tr>
        <tr>
            <td>typescript_analyzer.py</td>
            <td>~450</td>
            <td>TypeScript/TSX parser</td>
        </tr>
        <tr>
            <td>project_analyzer.py</td>
            <td>~400</td>
            <td>Project indexer, symbol tables</td>
        </tr>
        <tr>
            <td>call_graph.py</td>
            <td>~350</td>
            <td>Call graph construction</td>
        </tr>
        <tr>
            <td>function_summary.py</td>
            <td>~300</td>
            <td>Per-function taint summaries</td>
        </tr>
        <tr>
            <td>cross_file_taint.py</td>
            <td>~400</td>
            <td>Cross-file vulnerability detection</td>
        </tr>
        <tr>
            <td>enhanced_cross_file.py</td>
            <td>~400</td>
            <td>Async, closure, global tracking</td>
        </tr>
        <tr>
            <td>ai_analyzer.py</td>
            <td>~200</td>
            <td>DeepSeek AI integration</td>
        </tr>
    </table>

    <h3>Test Suite</h3>
    <table>
        <tr>
            <th>File</th>
            <th>Tests</th>
        </tr>
        <tr>
            <td>tests/test_edtech_rules.py</td>
            <td>Unit tests for 57 EdTech rules</td>
        </tr>
        <tr>
            <td>tests/test_cross_file.py</td>
            <td>Cross-file analysis tests</td>
        </tr>
        <tr>
            <td>tests/test_typescript.py</td>
            <td>TypeScript analyzer tests</td>
        </tr>
        <tr>
            <td>tests/test_integration.py</td>
            <td>Full system integration tests</td>
        </tr>
    </table>

    <div class="page-break"></div>

    <h2>9. Competitive Analysis</h2>

    <table>
        <tr>
            <th>Feature</th>
            <th>SASTify</th>
            <th>Semgrep</th>
            <th>SonarQube</th>
            <th>Snyk</th>
        </tr>
        <tr>
            <td>EdTech-Specific Rules</td>
            <td style="background:#28a745;color:white;">57 rules</td>
            <td>0</td>
            <td>0</td>
            <td>0</td>
        </tr>
        <tr>
            <td>FERPA/COPPA Detection</td>
            <td style="background:#28a745;color:white;">Yes</td>
            <td>No</td>
            <td>No</td>
            <td>No</td>
        </tr>
        <tr>
            <td>AI Prompt Injection</td>
            <td style="background:#28a745;color:white;">Yes</td>
            <td>Limited</td>
            <td>No</td>
            <td>No</td>
        </tr>
        <tr>
            <td>Cross-File Analysis</td>
            <td style="background:#28a745;color:white;">Yes</td>
            <td>Yes</td>
            <td>Yes</td>
            <td>Yes</td>
        </tr>
        <tr>
            <td>TypeScript Type Safety</td>
            <td style="background:#28a745;color:white;">Yes</td>
            <td>Limited</td>
            <td>Yes</td>
            <td>Yes</td>
        </tr>
        <tr>
            <td>Grade Manipulation Detection</td>
            <td style="background:#28a745;color:white;">Yes</td>
            <td>No</td>
            <td>No</td>
            <td>No</td>
        </tr>
        <tr>
            <td>Proctoring Evasion Detection</td>
            <td style="background:#28a745;color:white;">Yes</td>
            <td>No</td>
            <td>No</td>
            <td>No</td>
        </tr>
        <tr>
            <td>Free/Open Source</td>
            <td style="background:#28a745;color:white;">Yes</td>
            <td>Yes</td>
            <td>Partial</td>
            <td>Partial</td>
        </tr>
    </table>

    <div class="success">
        <strong>Unique Selling Point:</strong> SASTify is the ONLY SAST tool purpose-built for educational technology
        platforms with 57 EdTech-specific security rules covering FERPA, COPPA, exam integrity, AI/LLM security, and
        proctoring systems.
    </div>

    <div class="page-break"></div>

    <h2>10. Final Assessment</h2>

    <h3>Strengths</h3>
    <ul>
        <li><strong>EdTech Focus</strong> - 57 rules targeting educational platforms (unique in market)</li>
        <li><strong>Multi-Language</strong> - Python, JavaScript, TypeScript support</li>
        <li><strong>Real Taint Tracking</strong> - AST-based data flow, not just regex</li>
        <li><strong>Cross-File Detection</strong> - Professional inter-procedural analysis</li>
        <li><strong>AI Integration</strong> - Human-readable explanations via DeepSeek</li>
        <li><strong>Compliance Aware</strong> - FERPA and COPPA flagging</li>
    </ul>

    <h3>Areas for Improvement</h3>
    <ul>
        <li>Language coverage (add Java, C#, Go, PHP)</li>
        <li>Scalability on 100+ file projects</li>
        <li>CI/CD integrations (GitHub Actions, Jenkins)</li>
        <li>PDF/HTML report generation</li>
        <li>Enterprise features (multi-tenant, RBAC)</li>
    </ul>

    <h3>Overall Rating</h3>
    <table>
        <tr>
            <th>Category</th>
            <th>Rating</th>
        </tr>
        <tr>
            <td>Detection Accuracy</td>
            <td>8.5/10</td>
        </tr>
        <tr>
            <td>Coverage</td>
            <td>7/10</td>
        </tr>
        <tr>
            <td>EdTech Focus</td>
            <td>9.5/10</td>
        </tr>
        <tr>
            <td>Code Quality</td>
            <td>8/10</td>
        </tr>
        <tr>
            <td>Usability</td>
            <td>8/10</td>
        </tr>
        <tr>
            <td>Performance</td>
            <td>7/10</td>
        </tr>
        <tr>
            <td><strong>Overall</strong></td>
            <td><strong>8.5/10</strong></td>
        </tr>
    </table>

    <hr>
    <p style="text-align:center; color:#666;">
        <em>SASTify Technical Documentation v1.0 | December 2024</em>
    </p>

</body>

</html>